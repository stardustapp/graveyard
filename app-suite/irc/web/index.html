<!doctype html>
<title>starchat</title>
<link href="https://fonts.googleapis.com/css?family=Roboto|Material+Icons" rel="stylesheet">
<link href="app.css" type="text/css" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1">

<div id="app">
  <div id="navbar">
    <h2>starirc</h2>

    <div v-for="net in networks">
      <h3 class="topics-header">{{net.id}}</h3>
      <ul class="topics-list">
        <li v-for="ctx in net.contexts" :key="ctx.id">
          <router-link
              :to="{name:'context', params:{ network: net.id, context: ctx.id }}"
              class="topic-item">
              <span class="topic-prefix" v-if="ctx.prefix">{{ctx.prefix}}</span>
              {{ctx.mainName}}
          </router-link>
        </li>

        <!--li>
          <a href={{newTopicUrl}} class="new-topic">new topic...</a>
        </li-->
      </ul>
    </div>

  </div>

  <router-view></router-view>
</div>

<script type="text/x-template" id="view-context">
  <div id="contents">
    <header id="topic-header">
      <div id="th-left">
        <h3>{{ name }}</h3>
        <div id="th-bottom">
          <!-- star button -->
          <!-- member count -->
          <!-- <span class="topic">{ topic }</span> -->
        </div>
      </div>

      <div id="th-right">
        <!-- menu -->
      </div>
    </header>

    <ul class="scrollback" ref="log">
      <li v-for="line in scrollback">
        {{ line.text }}
        <!--span v-html="line.text"></span-->
        <a :href="urlFrom(line.text)"
           v-if="hasUrl(line.text)"
           target="_blank"
          ><i class="material-icons">launch</i></a>
      </li>
    </ul>

    <!--
    <div id="message-history">
      {{#each m in messages}}
        <div class="past-message">
          <div class="attribution">
            <strong class="author">{{ m.Author }}</strong>
            <span class="time">{{ timestamp m }}</span>
          </div>
          <p class="msg-text">{{ m.Text }}</p>
        </div>

      {{else}}
        <h3>Nothing has been said yet!</h3>
      {{/each}}
    </div>
    -->

    <send-message :channelName="name" :chanPath="path" />
  </div>
</script>

<script type="text/x-template" id="send-message">
  <form @submit.prevent="submit" id="message-box">
    <input type="text" name="body" autocomplete="false" v-model="message" required
         :placeholder="'Message ' + channelName" />
    <button type="submit">
      <i class="material-icons">send</i>
    </button>
  </form>
</script>

<script src="https://unpkg.com/vue"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
<script src="/~system/lib/skylink.js"></script>
<script src="app.js"></script>
