<!doctype html>
<title>starchat</title>
<link href="https://fonts.googleapis.com/css?family=Roboto|Material+Icons" rel="stylesheet">
<link href="app.css" type="text/css" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1">

<div id="app">
  <div id="navbar">

    <div v-for="net in networks">
      <h2>{{net.id}}</h2>
      <h3 class="topics-header">Channels</h3>
      <ul class="topics-list">
        <li v-for="ctx in net.channels" :key="ctx.id">
          <router-link
              :to="{name:'context', params:{ network: net.id, type: 'channels', context: ctx.id }}"
              class="topic-item">
              <span class="topic-prefix" v-if="ctx.prefix">{{ctx.prefix}}</span>
              {{ctx.mainName}}
          </router-link>
        </li>

        <h3 class="topics-header">Queries</h3>
        <li v-for="ctx in net.queries" :key="ctx.id">
          <router-link
              :to="{name:'context', params:{ network: net.id, type: 'queries', context: ctx.id }}"
              class="topic-item">
              {{ctx.id}}
          </router-link>
        </li>

        <li>
          <router-link
              :to="{name:'context', params:{ network: net.id, type: 'server', context: 'server-log' }}"
              class="topic-item">
              <span class="topic-prefix">~</span>
              server
          </router-link>
        </li>

        <!--li>
          <a href={{newTopicUrl}} class="new-topic">new topic...</a>
        </li-->
      </ul>
    </div>

  </div>

  <router-view></router-view>
</div>

<script type="text/x-template" id="rich-activity">
  <li class="rich-activity activity-entry">
    <div class="author" v-if="newAuthor">
      <div class="author-avatar"
          :style="'background-color:' + authorColor"
        >{{ author[0] }}</div>
      <span class="author-name"
          :style="'color:' + authorColor"
        >{{ author }}</span>
    </div>
    <span class="message">
      <span
          v-for="s in segments"
          :key="s.idx"
          :style="s.css"
        >{{s.text}}</span>
      <a :href="urlFrom"
          v-if="hasUrl"
          target="_blank"
        ><i class="material-icons">launch</i></a>
    </span>
    <span class="time">{{ timestamp }}</span>
  </li>
</script>

<script type="text/x-template" id="status-activity">
  <li class="status-activity activity-entry">
    <span class="status">{{ text }}</span>
    <span class="time">{{ timestamp }}</span>
  </li>
</script>

<script type="text/x-template" id="view-context">
  <div id="contents">
    <header id="topic-header">
      <div id="th-left">
        <h3>{{ name }}</h3>
        <div id="th-bottom">
          <!-- star button -->
          <!-- member count -->
          <!-- <span class="topic">{ topic }</span> -->
        </div>
      </div>

      <div id="th-right">
        <!-- menu -->
      </div>
    </header>

    <ul class="scrollback" ref="log">
      <component :is="line.component"
          v-for="line in scrollback"
          :key="line.id"
          :msg="line"
        />
    </ul>

    <send-message :channelName="name" :chanPath="path" />
  </div>
</script>

<script type="text/x-template" id="send-message">
  <form @submit.prevent="submit" id="message-box">
    <input type="text" name="body" autocomplete="false" v-model="message" required
         :placeholder="'Message ' + channelName" />
    <button type="submit">
      <i class="material-icons">send</i>
    </button>
  </form>
</script>

<script src="https://unpkg.com/vue"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
<script src="/~system/lib/skylink.js"></script>
<script src="colorize.js"></script>
<script src="app.js"></script>
